fix file connection leak
support conditional attributes
support reject attributes
support accept attributes